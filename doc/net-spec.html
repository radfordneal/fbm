<html>
<body>
<pre>


NET-SPEC:  Create a new network, or display specifications for existing net.

Net-spec creates a log file containing records describing the network
architecture and the associated priors.  The network architectures
that can be specified are described in <A HREF="net.html">net.doc</A> and <A HREF="net-models.PDF">net-models.PDF</A>.
When invoked with just a log file as argument, net-spec displays the
specifications of the network stored in that log file.

Usage:

    net-spec log-file N-inputs { N-hidden { flag } } N-outputs { flag }
             / { group=prior } 

or: 

    net-spec log-file [ "config" ]

The first form above is for specifying a network archicture. 

The second form is for displaying the network architecture stored in
the specified log file.  The optional "config" argument causes the
detailed configurations from cfg-i, cfg-h, and cfg-b flags to be
output, in fully-expanded form (as individual triplets or pairs).


Specifying layer sizes and flags.

N-inputs and N-outputs are the numbers of units in the input and
output layers.  The sizes of zero or more hidden layers are specified
between these.  Flags pertaining to a layer may be specified after the
argument giving the size of the layer, including flags that configure
connections (eg, to specify a convolutional layer).

For hidden layers, the activation function to use may be specified
using one of the following flags:

    tanh  identity  sin  softplus  square  cube

The default is tanh, the hyperbolic tangent function.  The identity
flag causes the output of a hidden unit in the layer to be identical
its summed input.  The sin flag specifies that the activation function
to be h(u) = sqrt(2)*sin(sqrt(2)*u).  The multiplications by sqrt(2)
in this activation function make a network with one hidden layer of
this type correspond in the limit of many hidden units to a Gaussian
process model with covariance function given by exp(-distance^2).  The
softplus activation function is h(u) = log(1+exp(u)).  The square and
cube activation functions are h(u) = x^2 and h(u) = x^3.

The following flag is supported for hidden layers and the output
layer:

    omit:[-]&lt;input&gt;{,&lt;input&gt;}

This specifies that connections from certain inputs are to be omitted
from those feeding into this layer (assuming that any inputs at all
are looked at, as specifed by later arguments).  If the "-" is placed
before the list of inputs, the list gives the inputs that are NOT
omitted.  Inputs are numbered starting with 1.

Hidden layers and the output layer may have configurations for biases
and for connections to input or hidden layers, specified using the
following flags:

    cfg-b:&lt;file&gt;
    cfg-i:&lt;file&gt;
    cfg-h#:&lt;file&gt;

except that the cfg-i flag may not be combined with an omit flag, the
cfg-h flag may not be specified for the first hidden layer, and the
cfg-i and cfg-h flags may not be specified if the layer has per-unit
adjustments for the prior on the associated connections.  The # part
of the cfg-h flag allows for separate configurations for the
connections to the various earlier hidden layers (numbered from 0); it
defaults to the previous hidden layer (the last hidden layer for
outputs).

The files given must contain specifications for which connections from
the input layer or a previous hidden layer, or which biases, are
present, and how the weight/bias parameters are used for these
connections or biases (with possible sharing of weights/biases between
connections). 

See <A HREF="net-config.html">net-config.doc</A> for documentation on how a configuration is
specified in a file.  The named configuration files do not need to
exist when the configuration is specified; they are read (and checked
for errors) only when needed later.  A configuration file may be
specified with an initial "%", in which case the remainder is a
command that is run to output the "file" contents.


Specifying layer connections and priors.

Following a "/", the priors for groups of weights, biases, offsets,
and adjustments are specified.  For the syntax of
a prior specification (except for adjustments), see <A HREF="prior.html">prior.doc</A>.  If "-"
is given instead of a prior specification (or if a prior specification
is omitted entirely), the parameters in question do not exist at all,
which is equivalent to their being zero.  For adjustments, the prior
is specified by a single "alpha" value.  A value of "-" represents
infinity (effectively eliminating the adjustment).  Omitting a prior
for a set of adjustments also eliminates them.

If a configuration file is specified for a group of connections, with
a cfg-i or cfg-h flag, the corresponding prior must not specifying a
value for Alpha-sub-group (see <A HREF="prior.html">prior.doc</A>), since sub-groups by source
unit are not well-defined when weights may be shared.  The prior must
also not have automatic width scaling (no "x" option).  Finally, the
prior for weights in a group with a configuration file is not affected
by the adjustments for its destination layer.

Groups of parameters are identified by name, sometimes with a hidden
layer number (from 0), as follows:

    ti      offsets for the inputs
    ih#     weights from inputs to hidden layer # (default for # is 0)
    bh#     biases for hidden layer # (default for # is 0)
    th#     offsets for hidden layer # (default for # is 0)
    h#h#    weights from the hidden layer identified by the first #
            to the hidden layer identified by the second # (which must
            be greater than the first)
    hh#     weights from hidden layer # minus 1 to hidden layer # 
            (default for # is 1)
    h#o     weights from hidden layer # to outputs (default for # is
            the last hidden layer)
    ho#     same as h#o
    io      weights from inputs to outputs
    bo      biases for outputs
    ah#     adjustments for hidden layer # (default for # is 0)
    ao      adjustments for outputs

The hidden layers are numbered starting with 0.

Note that a data model will also have to be specified (with model-spec)
if any learning is to be done.  

Two records are written to the newly created log file - one with type
'A' with a net_arch structure as data, and one with type 'P' with a
net_priors structure as data.  A record of type 'F' will be written as
well if any flags were specified.  These records have an index of -1.
When the second form of the command is used (with just the log file as
argument), these records are read and the information they contain is
displayed on standard output.

            Copyright (c) 1995-2021 by Radford M. Neal
</pre>
</body>
</html>
