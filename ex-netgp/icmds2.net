#!/bin/bash

# Commands to apply Bayesian neural network to an image classification problem,
# with convolutional connections.

for run in 1 2 3; do

  log=ilog2.net$run

  net-spec $log 36 80 input-config:iconfig 4 \
                / ih=0.2:2 bh=0.2:2 ho=0.2:2 bo=0.2:2
  model-spec $log class
  
  data-spec $log 36 1 4 / idata@1:1000 . idata@1001:1500 .

  rand-seed $log $run
  
  net-gen $log fix 0.$run

  mc-spec $log repeat 30 heatbath hybrid 100:10 0.12
  net-mc $log 1
  
  mc-spec $log sample-sigmas heatbath hybrid 3000:100 0.15
  net-mc $log 8000 &

done

wait
  
net-pred mnpa ilog2.net1 2001: ilog2.net2 2001: ilog2.net3 2001: \
              / idata@1501:3000 .
